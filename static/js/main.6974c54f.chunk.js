(this.webpackJsonpecohouse_v2=this.webpackJsonpecohouse_v2||[]).push([[0],{29:function(e,t,r){},30:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(8),o=r.n(s),c=r(7),i=c.c,u=r(9),d={loaded:!0,loading:!1,error:!1},l={loaded:!1,loading:!0,error:!1},h={loaded:!1,loading:!1,error:!0},f=Object(u.b)({name:"sensorStats",initialState:{data:[],status:{loaded:!1,loading:!1,error:!1}},reducers:{houseDataFetch:function(e){e.status=l},houseDataLoaded:function(e,t){e.status=d,e.data=t.payload},houseDataError:function(e){e.status=h}}}),b=f.actions,j=b.houseDataFetch,p=b.houseDataLoaded,m=b.houseDataError,x=f.reducer,g=r(10),O=r(16),v=(r(15),"rgb(255, 99, 132)"),y="rgb(255, 99, 132, 0.5)",w="rgb(54, 162, 235)",C="rgb(54, 162, 235, 0.5)",D=r(1);function F(){var e=i((function(e){return e.sensorStats})).data,t=Object(a.useState)(),r=Object(g.a)(t,2),n=r[0],s=r[1],o=e.map((function(e){return{x:e.timestamp,y:e.temp}})),c=e.map((function(e){return{x:e.timestamp,y:e.pressure}}));return Object(a.useEffect)((function(){var e=function(e,t){return new O.a("myChart",{type:"line",data:{datasets:[{data:e,borderColor:v,backgroundColor:y,label:"Temp",yAxisID:"tempY"},{data:t,borderColor:w,backgroundColor:C,label:"Pressure",yAxisID:"pressureY"}]},options:{maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},scales:{x:{type:"time",time:{tooltipFormat:"lll"},title:{display:!0,text:"Date"}},tempY:{type:"linear",display:!0,position:"left"},pressureY:{type:"linear",display:!0,position:"right",grid:{drawOnChartArea:!1}}}}})}(o,c);s(e)}),[]),Object(a.useEffect)((function(){n&&(!function(e,t,r){e.data.datasets[0].data=t,e.data.datasets[1].data=r,e.update()}(n,o,c),n.update())}),[n,o,c]),Object(D.jsx)("div",{className:"bg-white border-transparent rounded-lg shadow-xl p-10",style:{position:"relative",height:"60vh",width:"60vw"},children:Object(D.jsx)("canvas",{id:"myChart"})})}function N(e){return e.reduce((function(e,t){return e+=t.temp}),0)/e.length}function S(e){var t=e.filter((function(e){return e.pressure}));return t.reduce((function(e,t){return e+=t.pressure}),0)/t.length}var E=(new Date).toISOString().slice(0,10);function k(){var e=i((function(e){return e.sensorStats})).data,t=e[e.length-1],r=e.filter((function(e){return e.timestamp.includes(E)})),a=new Date(Date.parse(null===t||void 0===t?void 0:t.timestamp)).toLocaleString(),n=N(e),s=N(r),o=S(e),c=S(r);return Object(D.jsxs)("div",{className:"bg-white border-transparent rounded-lg shadow-xl p-10 h-full flex flex-col justify-between",children:[Object(D.jsxs)("div",{children:[Object(D.jsx)("h1",{className:"text-xl font-semibold mb-6",children:"Stats"}),"Current: ",null===t||void 0===t?void 0:t.temp.toFixed(2)," \xb0C",Object(D.jsx)("br",{}),Object(D.jsxs)("div",{className:"mb-4",children:["Today mean temperature: ",n.toFixed(2)," \xb0C ",Object(D.jsx)("br",{}),"All time mean temperature: ",s.toFixed(2)," \xb0C"]}),Object(D.jsxs)("div",{className:"mb-4",children:["Today mean pressure: ",o.toFixed(2)," hPa ",Object(D.jsx)("br",{}),"All time mean pressure: ",c.toFixed(2)," hPa"]})]}),Object(D.jsxs)("p",{className:"text-sm text-gray-400",children:["Last data: ",a]})]})}var L=r(14),A=r.n(L),I=r(17),P=function(){var e=Object(I.a)(A.a.mark((function e(){return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://8o8h5nqi81.execute-api.eu-west-2.amazonaws.com/tempData").then((function(e){return e.json()})).then((function(e){return e.Items.sort()})).catch((function(){return console.error("Couldn't fetch data"),[]})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();var T=function(){var e=(new Date).getFullYear(),t=Object(c.b)(),r=i((function(e){return e.sensorStats})).status;return Object(a.useEffect)((function(){t(j()),P().then((function(e){return t(p(e))})).catch((function(){return t(m())}))}),[t]),r.loading?Object(D.jsx)("div",{children:"Loading...."}):r.error?Object(D.jsx)("div",{children:"Error!"}):Object(D.jsxs)("div",{className:"min-h-screen h-full bg-gray-800 p-3 flex flex-col justify-between",children:[Object(D.jsx)("header",{className:"text-2xl font-bold text-white h-12 flex justify-center",children:"Eco house - dashboard"}),Object(D.jsxs)("main",{className:"flex flex-row flex-wrap p-6 justify-between items-stretch",children:[Object(D.jsx)("div",{className:"p-6",children:Object(D.jsx)(F,{})}),Object(D.jsx)("div",{className:"p-6 flex-grow",children:Object(D.jsx)(k,{})})]}),Object(D.jsxs)("footer",{className:"h-12 flex items-center justify-center w-full border-t text-white",children:["Created with \u2615 \xa0",Object(D.jsx)("a",{className:"hover:text-gray-400",href:"https://www.jkrymarys.pl/",children:"\xa0jkrymarys.pl\xa0"}),"\xa9\xa0",e]})]})},Y=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,31)).then((function(t){var r=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,o=t.getTTFB;r(e),a(e),n(e),s(e),o(e)}))},B=Object(u.a)({reducer:{sensorStats:x}});r(29);o.a.render(Object(D.jsx)(n.a.StrictMode,{children:Object(D.jsx)(c.a,{store:B,children:Object(D.jsx)(T,{})})}),document.getElementById("root")),Y()}},[[30,1,2]]]);
//# sourceMappingURL=main.6974c54f.chunk.js.map